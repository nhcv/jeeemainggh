<!DOCTYPE html>
<html>
<head>
  <title>Upload Questions to Firestore</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body style="font-family: Arial; padding: 20px; background: #f2f2f2;">

  <h2>📤 Upload CSV to Firestore</h2>
  <input type="file" id="csvFile" accept=".csv" />
  <br><br>
  <button onclick="uploadCSV()" style="padding: 10px 20px; font-size: 16px;">Upload</button>

  <script>
    // ✅ Your Firebase config (update if needed)
    const firebaseConfig = {
      apiKey: "AIzaSyC1-QozKp9e4HYUNyT1UziEyqqRW_UaqlQ",
      authDomain: "physicsgrab-8b59e.firebaseapp.com",
      projectId: "physicsgrab-8b59e",
      storageBucket: "physicsgrab-8b59e.appspot.com",
      messagingSenderId: "295747094512",
      appId: "1:295747094512:web:76d30aabf8a1f6c9804ef1"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function uploadCSV() {
      const fileInput = document.getElementById('csvFile');
      const file = fileInput.files[0];
      if (!file) {
        alert("Please select a CSV file.");
        return;
      }

      Papa.parse(file, {
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
          const data = results.data;
          const batch = db.batch();

          data.forEach(row => {
            const chapter = row.chapter.trim();
            const ref = db.collection("Chapters")
                         .doc("Class11")
                         .collection(chapter)
                         .doc(); // auto-ID

            batch.set(ref, {
              question: row.question,
              options: [row.option1, row.option2, row.option3, row.option4],
              answer: row.answer,
              solution: row.solution
            });
          });

          batch.commit().then(() => {
            alert("✅ Questions uploaded successfully!");
          }).catch((error) => {
            alert("❌ Upload failed: " + error.message);
          });
        }
      });
    }
  </script>
</body>
</html>